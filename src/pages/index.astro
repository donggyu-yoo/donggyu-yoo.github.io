---
const postFiles = await import.meta.glob('./Blog/*/*.md', { eager: true });

const posts = Object.entries(postFiles).map(([path, post]) => {
  const pathParts = path.split('/');
  const category = pathParts[pathParts.length - 2]; // e.g., "Food"

  return {
    url: path.replace('./', '/').replace('.md', '/'),
    title: post.frontmatter.title,
    date: post.frontmatter.date,
    category,
  };
});

posts.sort((a, b) => new Date(b.date) - new Date(a.date));
---
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>동규의 블로그</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="container">
      <aside class="sidebar">
        <h2>카테고리</h2>
        <ul>
          <li><a href="/Blog/Food/">🍽 음식(Food)</a></li>
          <li><a href="/Blog/Performance/">🎭 공연(Performance)</a></li>
          <li><a href="/Blog/Diary/">📔 일기(Diary)</a></li>
        </ul>
      </aside>

      <main class="content">
        <h1>동규의 블로그</h1>
        <p>최근 게시글을 확인하세요:</p>

        <ul>
          {posts.map(post => (
            <li>
              <a href={post.url}>
                <strong>[{post.category}]</strong> {post.title}
              </a><br />
              <small>{new Date(post.date).toLocaleDateString('ko-KR')}</small>
            </li>
          ))}
        </ul>
      </main>
    </div>
  </body>
</html>